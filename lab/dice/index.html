<!doctype html>
<html class="no-js" lang="EN-US">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Dice</title>
        <meta name="description" content="demo, testing and blog">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta property="og:url"           content="https://isken.me" />
        <meta property="og:type"          content="website" />
        <meta property="og:title"         content="Isken Huang's Lab" />
        <meta property="og:description"   content="demo, testing and blog" />
        <meta property="og:image"         content="https://isken.me/me.jpg" />
        <link rel="icon" href="/favicon.ico?v=1.1">
        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <link rel="stylesheet" href="/common.min.css">
        <!-- Place favicon.ico in the root directory -->
        <style>
            :root {
                --size: 100px;
                --bg-color: #f7f7f7;
                --dot-color: #333;
                --dot-size: 20px;
                --rotate-speed: 1s;
            }

            .cubes {
                display: flex;
                justify-content: center;
                align-items: center;
                flex-wrap: wrap;
                min-height: calc(var(--size)*2);
            }

            .cube-wrapper {
                min-width: var(--size);
                max-width: var(--size);
                height: var(--size);
                perspective: 300px;
                margin: calc(var(--size)/2);
                flex: 1;
            }

            .cube {
                width: 100%;
                height: 100%;
                position: relative;
                transform-style: preserve-3d;
                transform: rotateX(-30deg) rotateY(-45deg);
            }

            .cube.animation {
                animation: spin var(--rotate-speed) infinite linear;
            }

            @keyframes spin {
                0% { transform: rotateX(0deg) rotateY(0deg); }
                100% { transform: rotateX(360deg) rotateY(360deg); }
            }

            .face {
                position: absolute;
                width: 100%;
                height: 100%;
                background: var(--bg-color);
                border: 1px solid #e0e0e0;
                border-radius: 10%;
                box-shadow: inset 0 0 15px rgba(0,0,0,0.1);

                display: grid;
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: repeat(3, 1fr);
                padding: 8px;
                box-sizing: border-box;
            }

            .dot {
                width: var(--dot-size);
                height: var(--dot-size);
                background-color: var(--dot-color);
                border-radius: 50%;
                align-self: center;
                justify-self: center;
                box-shadow: inset 1px 1px 2px rgba(0,0,0,0.3);
            }

            .face-1 .dot { background-color: #f44336; width: calc(var(--dot-size)*1.5); height: calc(var(--dot-size)*1.5); }
            .face-1 { transform: translateZ(calc(var(--size) / 2)); }
            .face-2 { transform: rotateX(-90deg) translateZ(calc(var(--size) / 2)); }
            .face-3 { transform: rotateY(90deg) translateZ(calc(var(--size) / 2)); }
            .face-4 { transform: rotateY(-90deg) translateZ(calc(var(--size) / 2)); }
            .face-5 { transform: rotateX(90deg) translateZ(calc(var(--size) / 2)); }
            .face-6 { transform: rotateY(180deg) translateZ(calc(var(--size) / 2)); }

            /* Grid reference:
            1 2 3
            4 5 6
            7 8 9
            */
            .face-1 .dot:nth-child(1) { grid-area: 2 / 2; }
            .face-2 .dot:nth-child(1) { grid-area: 1 / 1; }
            .face-2 .dot:nth-child(2) { grid-area: 3 / 3; }
            .face-3 .dot:nth-child(1) { grid-area: 1 / 1; }
            .face-3 .dot:nth-child(2) { grid-area: 2 / 2; }
            .face-3 .dot:nth-child(3) { grid-area: 3 / 3; }
            .face-4 .dot:nth-child(1) { grid-area: 1 / 1; }
            .face-4 .dot:nth-child(2) { grid-area: 1 / 3; }
            .face-4 .dot:nth-child(3) { grid-area: 3 / 1; }
            .face-4 .dot:nth-child(4) { grid-area: 3 / 3; }
            .face-5 .dot:nth-child(1) { grid-area: 1 / 1; }
            .face-5 .dot:nth-child(2) { grid-area: 1 / 3; }
            .face-5 .dot:nth-child(3) { grid-area: 2 / 2; }
            .face-5 .dot:nth-child(4) { grid-area: 3 / 1; }
            .face-5 .dot:nth-child(5) { grid-area: 3 / 3; }
            .face-6 .dot:nth-child(1) { grid-area: 1 / 1; }
            .face-6 .dot:nth-child(2) { grid-area: 1 / 3; }
            .face-6 .dot:nth-child(3) { grid-area: 2 / 1; }
            .face-6 .dot:nth-child(4) { grid-area: 2 / 3; }
            .face-6 .dot:nth-child(5) { grid-area: 3 / 1; }
            .face-6 .dot:nth-child(6) { grid-area: 3 / 3; }
        </style>
    </head>
    <body>
        <h1 onclick="addCube()">Dice</h1>
        <div class="cubes"></div>
        <button onclick="addCube()">Add Dice</button>
        <button onclick="handleButton()">Roll</button>
        <script>
            const stopTime = 1600
            const $cubes = document.querySelector('.cubes')
            const DOTS_TRANSFORM = [
                'rotateX(0deg) rotateY(5deg)',
                'rotateX(90deg) rotateY(90deg)',
                'rotateX(0deg) rotateY(270deg)',
                'rotateX(0deg) rotateY(90deg)',
                'rotateX(270deg) rotateY(90deg)',
                'rotateX(0deg) rotateY(180deg)',
            ]
            window.addCube = function () {
                $cubes.innerHTML += getTemplate()
            }

            window.cubeGo = function (el) {
                const $cube = el.querySelector('.cube')
                const isAnimation = $cube.classList.contains('animation')
                if (isAnimation) {
                    $cube.classList.remove('animation')
                } else {
                    $cube.style.transform = 'rotateX(-30deg) rotateY(-45deg);'
                    $cube.classList.add('animation')
                    setTimeout(() => {
                        cubeGo(el)
                        $cube.style.transform = DOTS_TRANSFORM[randomCube()]
                    }, stopTime)
                }
            }

            window.handleButton = function () {
                $cubes.querySelectorAll('.cube').forEach(el => el.click())
            }

            // init
            addCube()

            function randomCube() {
                return Math.floor(Math.random() * DOTS_TRANSFORM.length)
            }

            function getTemplate() {
                return `<div class="cube-wrapper" onclick="cubeGo(this)">
    <div class="cube">
        <div class="face face-1">
            <div class="dot"></div>
        </div>
        <div class="face face-2">
            <div class="dot"></div><div class="dot"></div>
        </div>
        <div class="face face-3">
            <div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
        <div class="face face-4">
            <div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
        <div class="face face-5">
            <div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
        <div class="face face-6">
            <div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
        </div>
    </div>
</div>`
            }
        </script>
        <script>if (navigator.serviceWorker) { navigator.serviceWorker.register('/sw.js') }</script>
    </body>
</html>
